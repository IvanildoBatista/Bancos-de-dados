--Exercícios 2

-- Contar a quantidade de pedidos e agrupe por cidade (utilize a tabela ORDERS e CUSTOMERS)
SELECT CLIENTE.CUSTOMER_CITY, SUM(ORDER_ID) FROM ORDERS PEDIDO INNER JOIN CUSTOMERS CLIENTE
ON PEDIDO.CUSTOMER_ID = CLIENTE.CUSTOMER_ID GROUP BY CLIENTE.CUSTOMER_CITY

-- Selecione o ID do Pedido, o ID do Cliente, a cidade do cliente e o estado mesmo que este não esteja presente na tabela CUSTOMERS
SELECT ORDER_ID
, PEDIDO.ORDER_STATUS, CLIENTE.CUSTOMER_ID, CLIENTE.CUSTOMER_ID, CLIENTE.CUSTOMER_STATE FROM ORDERS PEDIDO LEFT JOIN CUSTOMERS CLIENTE
ON PEDIDO.CUSTOMER_ID = CLIENTE.CUSTOMER_ID

--Selecione o ID do pedido, a quantidade de fotos, o preço, o tipo de pagamento e o valor de pagamento dos produtos
-- que tem mais de 3 fotos (utilize as tabelas : pedidos, pagamentos e itens)
SELECT PEDIDOS.ORDER_ID AS ID_DO_PEDIDO
    , PRODUTOS.PRODUCT_PHOTOS_QTY AS QUANTIDADE
    , ITENS.PRICE AS PREÇO
    , PAGAMENTOS.PAYMENT_TYPE AS TIPO_DE_PAGAMENTO
    ,PAGAMENTOS.PAYMENT_VALUE AS VALOR_DO_PAGAMENTO
     FROM ORDER_ITEMS ITENS INNER JOIN PRODUCTS PRODUTOS
ON ITENS.PRODUCT_ID = PRODUTOS.PRODUCT_ID

INNER JOIN ORDERS PEDIDOS 
ON PEDIDOS.ORDER_ID = ITENS.ORDER_ID

INNER JOIN ORDER_PAYMENTS PAGAMENTOS
ON PAGAMENTOS.ORDER_ID = PEDIDOS.ORDER_ID

WHERE PRODUTOS.PRODUCT_PHOTOS_QTY > 3